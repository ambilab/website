@import 'tailwindcss';

@plugin 'tailwindcss-debug-screens';

@custom-variant dark (@media (prefers-color-scheme: dark));

@theme {
    --font-sans: 'Innovator Grotesk', system-ui, sans-serif;
    --font-mono: 'Departure Mono', ui-monospace, 'SF Mono', Menlo, Monaco, Consolas, monospace;
    --font-display: 'Nerissimo', system-ui, sans-serif;

    /* Semantic Colors - Page & Surface Backgrounds */
    --color-page-bg: theme('colors.zinc.200');

    --color-surface: theme('colors.white');
    --color-surface-code: theme('colors.gray.100');

    /* Semantic Colors - Borders */
    --color-border-default: theme('colors.zinc.900');
    --color-border-medium: theme('colors.gray.600');
    --color-border-subtle: theme('colors.gray.300');

    /* Semantic Colors - Text */
    --color-text-primary: theme('colors.zinc.900');
    --color-text-secondary: theme('colors.zinc.600');
    --color-text-muted: theme('colors.zinc.600');

    /* Semantic Colors - Links (lime.700 for WCAG AA 4.5:1 on page-bg) */
    --color-link: theme('colors.lime.700');
    --color-link-hover: theme('colors.lime.800');
    --color-link-active: theme('colors.black');

    /* Semantic Colors - Card */
    --color-card-bg: theme('colors.lime.700');
    --color-card-text: theme('colors.white');

    /* Semantic Colors - Stickie */
    --color-stickie-bg: theme('colors.yellow.400');
    --color-stickie-text: theme('colors.black');

    /* Semantic Colors - Primary Button */
    --color-button-primary-bg: theme('colors.lime.700');
    --color-button-primary-bg-hover: theme('colors.lime.800');
    --color-button-primary-text: theme('colors.white');
    --color-button-primary-text-hover: theme('colors.white');

    /* Semantic Colors - Secondary Button */
    --color-button-secondary-bg: theme('colors.zinc.900');
    --color-button-secondary-bg-hover: theme('colors.zinc.900');
    --color-button-secondary-text: theme('colors.white');
    --color-button-secondary-text-hover: theme('colors.white');

    /* Semantic Colors - Outline Button */
    --color-button-outline-bg: theme('colors.zinc.200');
    --color-button-outline-bg-hover: theme('colors.zinc.200');
    --color-button-outline-text: theme('colors.zinc.900');
    --color-button-outline-text-hover: theme('colors.black');
    --color-button-outline-border: theme('colors.zinc.900');
    --color-button-outline-border-hover: theme('colors.black');

    /* Semantic Colors - Active States */
    --color-active: #bdd0a2;

    /* Semantic Colors - Focus States */
    --color-focus-ring: #7aa740;

    /* Semantic Colors - Accents */
    --color-info-bg: theme('colors.lime.50');
    --color-info-border: theme('colors.lime.500');
    --color-warning-bg: theme('colors.yellow.50');
    --color-warning-border: theme('colors.yellow.200');
    --color-warning-text: theme('colors.yellow.600');
    --color-warning-heading: theme('colors.yellow.800');
    --color-warning-highlight: theme('colors.yellow.200');
    --color-success-text: theme('colors.lime.600');
    --color-error-text: theme('colors.red.600');
    --color-error-bg: theme('colors.red.50');

    /* Semantic Colors - Tags/Badges */
    --color-tag-bg: theme('colors.lime.100');
    --color-tag-text: theme('colors.lime.800');

    /* Semantic Colors - Footer */
    --color-footer-bg: theme('colors.zinc.900');
    --color-footer-text: theme('colors.zinc.200');

    /* Vertical rhythm (8px grid) */
    --spacing-rhythm: 8px;

    /* Line heights for vertical rhythm - define as utilities */
    --line-height-rhythm-2: 16px;
    --line-height-rhythm-3: 24px;
    --line-height-rhythm-4: 32px;
    --line-height-rhythm-5: 40px;

    /* Dot pattern background */
    --bg-dots-image: radial-gradient(circle, rgba(0, 0, 0, 0.04) 1px, transparent 1px);

    /* Z-index values */
    --z-index-header: 50;
    --z-index-mobile-menu: 60;
    --z-index-header-bar: 100;
    --z-index-cookie-banner: 110;
    --z-index-go-to-top: 120;
    --z-index-skip-navigation-link: 200;
}

@media (prefers-color-scheme: dark) {
    :root {
        color-scheme: dark;

        /* Dot pattern background for dark mode */
        --bg-dots-image: radial-gradient(circle, rgba(255, 255, 255, 0.04) 1px, transparent 1px);

        /* Semantic Colors - Page & Surface Backgrounds */
        --color-page-bg: theme('colors.zinc.900');

        --color-surface: theme('colors.zinc.600');
        --color-surface-code: theme('colors.gray.800');

        /* Semantic Colors - Borders */
        --color-border-default: theme('colors.zinc.200');
        --color-border-medium: theme('colors.gray.500');
        --color-border-subtle: theme('colors.gray.800');

        /* Semantic Colors - Text */
        --color-text-primary: theme('colors.zinc.200');
        --color-text-secondary: theme('colors.zinc.400');
        --color-text-muted: theme('colors.zinc.400');

        /* Semantic Colors - Links */
        --color-link: theme('colors.lime.400');
        --color-link-hover: theme('colors.lime.300');
        --color-link-active: theme('colors.white');

        /* Semantic Colors - Card */
        --color-card-bg: theme('colors.lime.500');
        --color-card-text: theme('colors.black');

        /* Semantic Colors - Stickie */
        --color-stickie-bg: theme('colors.yellow.400');
        --color-stickie-text: theme('colors.black');

        /* Semantic Colors - Primary Button */
        --color-button-primary-bg: theme('colors.lime.500');
        --color-button-primary-bg-hover: theme('colors.lime.400');
        --color-button-primary-text: theme('colors.black');
        --color-button-primary-text-hover: theme('colors.black');

        /* Semantic Colors - Secondary Button */
        --color-button-secondary-bg: theme('colors.zinc.200');
        --color-button-secondary-bg-hover: theme('colors.zinc.100');
        --color-button-secondary-text: theme('colors.black');
        --color-button-secondary-text-hover: theme('colors.black');

        /* Semantic Colors - Outline Button */
        --color-button-outline-bg: theme('colors.zinc.900');
        --color-button-outline-bg-hover: theme('colors.zinc.900');
        --color-button-outline-text: theme('colors.zinc.200');
        --color-button-outline-text-hover: theme('colors.white');
        --color-button-outline-border: theme('colors.zinc.200');
        --color-button-outline-border-hover: theme('colors.white');

        /* Semantic Colors - Active States */
        --color-active: #2b341a;

        /* Semantic Colors - Focus States */
        --color-focus-ring: #668e20;

        /* Semantic Colors - Accents */
        --color-info-bg: theme('colors.lime.950');
        --color-warning-bg: theme('colors.yellow.950');
        --color-warning-border: theme('colors.yellow.900');
        --color-warning-text: theme('colors.yellow.400');
        --color-warning-heading: theme('colors.yellow.200');
        --color-warning-highlight: theme('colors.yellow.800');
        --color-success-text: theme('colors.lime.400');
        --color-error-text: theme('colors.red.400');
        --color-error-bg: theme('colors.red.950');

        /* Semantic Colors - Tags/Badges */
        --color-tag-bg: theme('colors.lime.900');
        --color-tag-text: theme('colors.lime.200');

        /* Semantic Colors - Footer */
        --color-footer-bg: theme('colors.zinc.200');
        --color-footer-text: theme('colors.zinc.900');
    }
}

@layer components {
    /* Card component - full-bleed layout card with semantic colors and scoped element styles */
    .card {
        @apply -mx-4 px-4 pb-[2px] pt-4;
        @apply bg-card-bg text-card-text;

        & h2 {
            @apply mb-2 mt-px text-[20px] leading-5;
            @apply md:text-[24px] md:mb-3 md:mt-[2px] md:leading-6;
        }

        & h3 {
            @apply text-[20px] mb-2 mt-px leading-5;
            @apply md:text-[24px] md:mt-[2px] md:leading-6;
        }

        & p {
            @apply text-balance pb-2.5 text-[14px] leading-5;
            @apply md:pb-4 md:text-base;
        }

        & .meta {
            @apply mb-1 md:mb-3;
        }
    }

    /* Card shadow modifier - stacked shadow effect at sm+ breakpoint */
    .card-shadows {
        @media (min-width: theme('screens.sm')) {
            box-shadow:
                0 2px 0 0 var(--color-page-bg),
                0 4px 0 0 var(--color-card-bg);
        }
    }
}

@layer utilities {
    /* Dot background pattern */
    .bg-dots {
        background-image: var(--bg-dots-image);
        background-size: 8px 8px;

        /**
        * Background position: 0 3.5px
        *
        * This half-pixel vertical shift (3.5px = 8px / 2 - 0.5px) better aligns
        * the dots to the 8px rhythm grid. Adjusted for visual harmony with the
        * vertical rhythm system.
        */
        background-position: 0 3.5px;
    }

    /* Meta typography - monospace label style used across components */
    .meta {
        @apply font-mono text-[11px] uppercase leading-3 antialiased;
    }

    /* Vertical Rhythm Debug Overlay */
    @media (min-width: theme('screens.md')) {
        .debug-rhythm {
            background-image:
                linear-gradient(to bottom, rgba(255, 0, 0, 0.25) 0 1px, transparent 1px),
                linear-gradient(to bottom, rgba(255, 0, 0, 0.1) 0 1px, transparent 1px);
            background-size:
                100% calc(var(--spacing-rhythm) * 4),
                100% var(--spacing-rhythm);
            background-position:
                0 calc(var(--spacing-rhythm) * -2),
                0 calc(var(--spacing-rhythm) * -2);
        }
    }
}

:root {
    color-scheme: light dark;
}

html {
    /*noinspection CssNoGenericFontName*/
    font-family: var(--font-sans);

    /**
     * Unitless line-height: 1.5
     *
     * 24px = 3x8 grid, defines 1rlh at default 16px root font size.
     * Note: This value is relative to font-size. If font-size changes
     * (e.g., responsive typography, user settings), the computed line-height
     * will scale proportionally. The rhythm grid overlay uses fixed pixel
     * values (8px/32px) and will not automatically align if font-size changes.
     */
    line-height: 1.5;
}

body {
    min-height: 100vh;
    text-rendering: optimizeLegibility;
    font-variant-ligatures: common-ligatures;

    /**
     * OpenType font features for Innovator Grotesk.
     *
     * Enabled features (1):
     * - kern: Kerning for improved letter spacing
     * - liga: Standard ligatures (fi, fl, etc.)
     * - clig: Contextual ligatures
     * - dlig: Discretionary ligatures
     * - zero: Slashed zero for clarity
     * - tnum: Tabular numbers for alignment in tables
     * - cv01: Character variant 1
     * - cv08: Character variant 8
     * - cv13: Character variant 13
     *
     * Disabled features (0):
     * - calt: Contextual alternates (disabled for consistency)
     * - cv02-cv07, cv09-cv12, cv14-cv15: Character variants (not used)
     * - ss01-ss03: Stylistic sets (not used)
     *
     * Note: Unsupported features are silently ignored by browsers.
     */
    font-feature-settings:
        'kern' 1,
        'liga' 1,
        'clig' 1,
        'dlig' 1,
        'calt' 0,
        'zero' 1,
        'tnum' 1,
        'cv01' 1,
        'cv02' 0,
        'cv03' 0,
        'cv04' 0,
        'cv05' 0,
        'cv06' 0,
        'cv07' 0,
        'cv08' 1,
        'cv09' 0,
        'cv10' 0,
        'cv11' 0,
        'cv12' 0,
        'cv13' 1,
        'cv14' 0,
        'cv15' 0,
        'ss01' 0,
        'ss02' 0,
        'ss03' 0;
}

h1,
h2,
h3 {
    font-family: var(--font-display);

    /**
     * OpenType font features for Nerissimo.
     *
     * Enabled features (1):
     * - kern: Kerning for improved letter spacing
     * - liga: Standard ligatures
     * - clig: Contextual ligatures
     * - calt: Contextual alternates for better text flow
     * - onum: Oldstyle figures (varying heights, descenders for 3,4,5,7,9)
     * - pnum: Proportional figures (variable-width numbers)
     * - zero: Slashed zero for clarity
     *
     * Disabled features (0):
     * - dlig: Discretionary ligatures (not used)
     * - lnum: Lining figures (disabled in favor of oldstyle)
     * - tnum: Tabular figures (disabled in favor of proportional)
     *
     * Note: Nerissimo uses different OpenType features than Innovator Grotesk.
     * Oldstyle figures provide a more elegant, traditional appearance for headings.
     */
    font-feature-settings:
        'kern' 1,
        'liga' 1,
        'clig' 1,
        'calt' 1,
        'dlig' 0,
        'zero' 1,
        'tnum' 0;

    font-variant-numeric: lining-nums;
    text-transform: uppercase;
    text-wrap: balance;
}

/* Focus styles for accessibility */
*:focus-visible {
    @apply outline-4 outline-offset-2 outline-focus-ring;
}

/* Smooth scroll behavior (respects prefers-reduced-motion) */
@media (prefers-reduced-motion: no-preference) {
    html {
        scroll-behavior: smooth;
    }
}

/* View Transitions (gradient wipe animation) */
@media (prefers-reduced-motion: no-preference) {
    ::view-transition-old(root),
    ::view-transition-new(root) {
        animation-duration: 300ms;
        animation-timing-function: cubic-bezier(0.27, 0, 0.51, 1);
    }
}

/* Reduced motion: instant transitions with no mask effects */
@media (prefers-reduced-motion: reduce) {
    ::view-transition-old(root),
    ::view-transition-new(root) {
        animation-duration: 0.001s;
        animation-name: none;
        mask-image: none;
    }

    /* Disable Tailwind animation utilities (animate-spin, animate-pulse, etc.) */
    .animate-spin,
    .animate-ping,
    .animate-pulse,
    .animate-bounce {
        animation: none !important;
    }
}

/* Selection colors */
::selection {
    background-color: theme('colors.lime.300');
    color: theme('colors.lime.800');
}

@media (prefers-color-scheme: dark) {
    ::selection {
        background-color: theme('colors.lime.700');
        color: theme('colors.lime.100');
    }
}

.expressive-code {
    @apply -mx-3 pb-4 sm:-mx-6;
}

/* Print styles */
@media print {
    * {
        background: transparent !important;
        color: black !important;
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]::after {
        content: ' (' attr(href) ')';
    }

    abbr[title]::after {
        content: ' (' attr(title) ')';
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group;
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}
